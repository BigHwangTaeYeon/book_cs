from 절의 서브쿼리는 JPA JPQL 서브쿼리의 한계점으로 지원하지 않는다.
당연히 QueryDSL 도 지원하지 않는다.
하이버네이트 구현체를 사용하면 select 절의 서브쿼리는 지원한다.
QueryDSL 도 하이버네이트 구현체를 사용하면 select 서브쿼리를 지원한다.

해결방안
1. 서브쿼리를 join 으로 변경 (불가능할 수도 있다)
2. 어플리케이션에서 쿼리를 2번 분리해서 실행한다 (성능 이슈가 발생할 수도 있다.)
3. nativeSQL 을 사용한다.

하이버네이트 6.1 부터 from 서브쿼리를 지원하지만, QueryDSL 에서 아직 안되고, 서드파티에서 사용이 가능하다.

DB 에서는 Case 문 같은 걸 웬만하면 사용하지말자.
DB 는 로우 데이터를 필터링하고 그룹핑하거나 필요하면 계산도 하지만 최소한의 필터링으로 데이터를 줄이는 역할만 하자.

.when(member.age.between(0, 20)).then("0~20")
위와 같은 예문은 presentation layer 에서 보통 하자.