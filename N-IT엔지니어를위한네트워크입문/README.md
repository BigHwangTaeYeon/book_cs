# IT 엔지니어를 위한 네트워크 입문
IT 엔지니어를 위한 네트워크 입문 / 고재성, 이상훈 지음

```text
1. 네트워크 시작하기
	a 네트워크 구성도 살펴보기
		홈 네트워크
			홈 네트워크를 구성하는 데는 물리적(모뎀, 공유기) 연결이 필요하다.
			무선연결은 무선 랜 카드와 무선 신호를 보낼 수 있는 매체(공기)가 필요하고 유선 연결은 유선 랜 카드(이더넷 랜 카드: 일반적으로 보드에 내장됨), 랜 케이블(랜선)이 필요하다.
		데이터 센터 네트워크
			안정적이고 빠른 대용량 서비스 제공을 목표로 한다.
			기존에는 3계층(3-tier-architecture, core-aggregation-access) 구성이 일반적이었지만 가상화, 높은 대역폭을 요구하는 스케일 아웃 기반의 애플리케이션 서비스로 2계층(spine-leaf) 구조로 데이터 센터 네트워크가 변화되었다.
				스파인-리프 구조는 서버 간 통신이 늘어나는 최근 트래픽 경향을 지원하기 위해 제안되었습니다.
	b 프로토콜
		네트워크에서 통신할 때의 규약을 프로토콜이라는 용어를 사용한다.
		최근에는 복잡하고 산재되어 있던 여러가지 프로토콜 기술이 이더넷-TCP/IP 기반 프로토콜들로 변경되고 있다.
			물리적 : 데이터 전송 매체, 신호 규약, 회선 규격 등. 이더넷이 널리 쓰인다.
			논리적 : 장치들끼리 통신하기 위한 프로토콜 규격. TCP/IP가 널리 쓰인다.
		한정된 자원으로 통신을 수행해야 하다 보니 최대한 적은 데ㅐ이터를 이용해 효율적인 프로토콜을 정의
		문자 기반이 아닌 2진수 비트(bit) 기반으로 만들어졌습니다.
			몇 번째 전기 신호는 보내는 주소, 몇 번째 전기 신호는 받는 주소..
		애플리케이션 레벨의 프로토콜은 문자 기반 프로토콜들이 많이 사용
			HTTP와 SMTP이 대표적
			문자 자체를 이용해 헤더와 헤더 값, 데이터를 표현하고 전송
			text 파일과 같은 데이터가 전달되기에 효율성은 떨어지지만 비트 기반보다 다양한 확장이 가능
		TCP/IP는 프로토콜 스택이라 부른다.
			별도 계층에서 동작하는 프로토콜이지만 함께 사용하는데, 이런 프로토콜 묶음을 프로토콜 스택이라 부른다.
			실제 TCP/IP 프로토콜 스택에는 UDP, ICMP, ARP, HTTP, SMTP, FTP 등 다양한 애플리케이션 레이어 프로토콜이 존재
		TCP/IP 프로토콜 스택은 총 4개 부분
			물리 부분인 이더넷
			네트워크 계층 - 데이터가 목적지를 찾아가게 해줌
			전송 계층 - 잘린 패킷을 데이터 형태로 잘 조합하도록 도와줌
			애플리케이션 계층
	c OSI 7계층과 TCP/IP
		OSI 7 계층
			과거에는 통신용 규약이 표준화되지 않았고 각 벤더에서 별도로 개발했기에 호환되지 않는 시스템이나 애플리케이션이 많았고 통신이 불가능했다.
			하나의 규약으로 통합한 것이 OSI 7계층이며, 현재는 대부분의 프로토콜이 TCP/IP 프로토콜 스택 기반으로 되어 있다.
			계층별로 프로토콜을 개발해 네트워크 구성 요소들을 모듈화할 수 있다.
				모듈화된 요소는 기존에 개발된 프로토콜과 연동해 사용할 수 있다.
			1~4 계층 : 데이터 플로 계층(Data Flow Layer) / 하위 계층(Lower Layer)
			5~7 계층 : 애플리케이션 계층(Application Layer) / 상위 계층(Upper Layer)
				데이터 플로 계층은 데이터를 상대방에게 잘 전달하는 역할
				애플리케이션 개발자는 하위 데이터 플로 계층을 고려하지 않고 데이터를 표현하는 데 초점
				애플리케이션 개발자는 하향식(Top-Down) 형식으로 네트워크를 바라보고 네트워크 엔지니어는 상향식(Bottom-up) 형식으로 네트워크를 인식한다.
		TCP/IP 프로토콜 스택
			TCP/IP는 이론보다 실용성에 중점을 둔 프로토콜
			OSI 레퍼런스 모델은 7계층으로 이루어진 반면, TCP/IP 모델은 4계층으로 구분
			OSI 7계층은 데이터 플로 계층과 애플리케이션 계층으로 구분할 수 있다.
			이 두 계층의 구분은 데이터를 만드는 애플리케이션 부분과 이 데이터를 잘 전달하는 데 집중하는 하부 계층으로 구분하는 것이 목적
	d OSI 7계층별 이해하기
		1 계층(피지컬 계층)
			주로 전기 신호 전달하는 데 초점
			장비
				주요 장비 - 허브(hub), 리피터(repeater), 케이블(cable), 커넥터(connector), 트랜시버(tranceiver), 탭(tap)
				허브, 리피터는 네트워크 통신 중재 장비
				케이블과 커넥터는 케이블 본체를 구성하는 요소
				트랜시버는 랜카드와 케이블을 연결하는 장비
				탭은 네트워크 모니터링과 패킷 분석을 위해 전기 신호를 다른 장비로 복제
			흐름
				전기 신호를 그대로 잘 전달하는 것이 목적
				1계층 장비에 들어오면 전기 신호를 재생성하여 내보낸다
				주소 개념이 없으므로 전기 신호가 들어온 포트를 제외하고 모든 포트에 같은 전기 신호를 전송
		2 계층(데이터 링크 계층)
			전기 신호를 모아 데이터 형태로 처리
			전기 신호를 정확히 전달하기보다는 주소 정보를 정의하고 정확한 주소로 통신하는 역할
			출발지와 도착지 주소의 개념이 생겨 주소를 확인하고 검사한 후 데이터 처리를 수행
			데이터 에러 탐지 및 고치는 역할 수행
				이더넷 기반 네트워크의 2계층에서는 에러를 탐지하는 역할만 수행
			주소 체계가 생긴다는 의미는 여러 명과 통신할 수 있다는 것이므로 받는 사람이 현재 데이터를 받을 수 있는지 확인하는 작업을 하는데
				이 역할을 플로 컨트롤(Flow Control)이라 한다.

			구성요소는 NIC(Network Interface Card)와 스위치
			중요한 특징은 MAC 주소라는 주소 체계
			NIC, Switch 모두 MAC 주소를 이해할 수 있고, Switch는 MAC 주소를 보고 통신할 포트를 지정해 내보내는 능력이 있다.

			NIC 
				PC나 서버에서 네트워크를 연결해주는 카드나 인터페이스를 지칭
				NIC에는 고유 MAC 주소가 있다.
				지칭하는 예
					1. 네트워크 인터페이스 카드 또는 네트워크 인터페이스 컨트롤러, NIC
					2. 네트워크 카드
					3. 랜 카드, 과거 이더넷은 LAN(Local Area Network)에서만 사용
					4. 물리 네트워크 인터페이스(Physical Network Interface)
					5. 이더넷 카드(Ethernet Card)
					6. 네트워크 어댑터(Network Adapter)
				동작 방식
					1. 전기 신호를 데이터 형태로 변환
					2. 목적지, 출발지 MAC 주소 확인
					3. NIC MAC 주소 확인
					4. 목적지 MAC 주소와 NIC의 MAC 주소가 맞으면 데이터 처리, 다르면 폐기
						(맞으면 데이터를 상위 계층에서 처리할 수 있도록 메모리에 적재)
			스위치
				단말(terminal)이 어떤 MAC 주소인지, 연결된 포트는 어느 것인지 주소 습득(Address Learning) 과정에서 알 수 있다.
				단말들이 통신할 때 포트를 적절히 필터링하고 정확한 포트로 포워딩한다.
				네트워크 전체에 불필요한 처리가 감소하며 네트워크 효율성을 크게 향상 시키며 이더넷 기반 네트워크가 급증하게 된 계기
		3 계층(네트워크 계층)
			IP 주소와 같은 논리적인 주소가 정의
			데이터 통신에는 2계층 물리적 MAC 주소와 3계층 논리적 IP 주소를 사용
			IP 주소는 네트워크 주소 부분과 호스트 주소 부분으로 나뉜다.
			장비나 단말은 네트워크 주소 정보를 이용하여 자신이 속한 네트워크와 원격지 네트워크를 구분하고 원격지 네트워크로 어디로 가야 하는지 경로를 지정하는 능력이 있다.
			172.	31.		0.		1
			[네트워크 주소]		[호스트 주소]
			3계층에서 동작하는 장비는 라우터이며 IP 주소를 사용해 최적의 경로를 찾아주고 해당 경로로 패킷을 전송하는 역할
		4 계층(트랜스포트 계층)
			데이터들이 정상적으로 잘 보내지도록 확인하는 역할
			패킷 네트워크는 데ㅐ이터를 분할해 패킷을 실어보내다 보니 중간에 패킷이 유실되거나 순서가 바뀌는 경우가 생길 수 있다.
				이러한 문제를 바로잡아주는 역할을 4계층에서 담당 한다.
			4계층에서 패킷을 분할할 때 패킷 헤더에 보내는 순서와 받는 순서를 적어 통신하므로 유실되면 재전송을 요청하고 순서가 바뀌어도 바로 잡을 수 있다.
			순서를 명시한 것이 시퀀스 번호(Sequence Number)이고 받는 순서가 ACK 번호(Acknowledgement Number)이다.
			애플리케이션을 구분하는 포트 번호(Port Number)를 사용한다.
			장비로는 로드 밸런서와 방화벽이 있다.
				Port, Sequence, ACK 번호 정보를 이용해 부하를 분산하거나 보안 정책을 수립해 패킷을 통과, 차단하는 기능을 수행한다.
		5 계층(세션 계층, session layer)
			양 끝단의 응용 프로세스가 연결을 성립하도록 도와주고 연결이 안정적으로 유지되도록 관리하고 작업 완료 후에는 이 연결을 끊는 역할
			TCP/IP 세션을 만들고 없애는 책임을 가진다.
			에어로 중단된 통신에 대한 에러 복구와 재전송도 수행
		6 계층(프레젠테이션 계층, presentation layer)
			다른 애플리케이션이나 시스템 간의 통신을 돕기 위해 하나의 통일된 구문 형식으로 변환시키는 기능을 수행
				시스템의 응용 계층에서 데이터의 형식상 차이를 다루는 부담을 덜어준다.
				MIME 인코딩이나 암호화, 압축, 코드 변환과 같은 동작
		7 계층(애플리케이션 계층)
			프로세스를 정의하고 애플리케이션 서비스를 수행
			네트워크 소프트웨어의 UI 부분이나 사용자 입출력 부분을 정의하는 역할

		계층			주요 프로토콜 										장비
		애플리케이션 	HTTP, SMP, SMTP, STUN, TFTP, TELNET				ADC, NGFW, WAF
		프레젠테이션	TLS, AFP, SSH
		세션을		L2TP, PPTP, NFS, RPC, RTCP, SIP, SSH
		트랜스포트		TCP, UDP, SCTP, DCCP, AH, AEP					로드 밸런서, 방화벽
		네트워크 		ARP, IPv4, IPv6, NAT, IPSec, VRRP, 라우팅 프로토콜 	라우터, L3 스위치
		데이터 링크	IEEE 802.2, FDDI 								스위치, 브릿지, 네트워크 카드
		피지컬		RS-232, RS-449, V.35, S 등의 케이블 				케이블, 허브, 탭(TAP)
	e 인캡슐레이션과 디캡슐레이션
		상위 계층에서 하위 계층으로 데이터를 보내면 물리 계층에서 전기 신호 형태로 네트워크를 통해 신호를 보내고 (인캡슐레이션, Encapsulation)
		받는 쪽에서는 하위 계층에서 상위 계층으로 데이터를 보낸다. (디캡슐레이션, Decapsulation)

		애플리케이션에서 데이터를 플로 계층(1~4계층)으로 내려보내며 패킷에 데이터를 넣을 수 있도록 분할하는데 이 과정을 인캡슐레이션이라 부른다.
			4계층부터 네트워크 전송을 위한 정보를 헤더에 붙여 넣는다.
			헤더 정보는 4계층, 3계층, 2계층에서 각각 자신이 필요한 정보를 추가하는데, 미리 정의된 비트 단위(0 또는 1)로 쓴다.
			데이터 플로 계층에서만 3개의 헤더 정보가 추가 된다.

		디캡슐레이션 과정은 전기 신호를 데이터 형태로 만들어 2계층으로 올려 보낸다.
			2계층 헤더에 포함된 정보를 확인하고 목적지가 자신이 아니면 버린다(NIC 역할)
			맞으면 2계층 헤더 정보는 필요 없으므로 벗겨내고 3계층으로 정보를 보내준다
			동일한 방식으로 4계층 위까지 올리게 된다.

		인캡슐레이션, 디캡슐레이션 과정을 통해 데이터가 전송되는 과정
		각 계층 헤더를 이용하여 송신자 계층과 수신자 계층 간의 논리적 통신 과정

		헤더에 두 가지 정보는 반드시 포함되어야 한다.
			1. 현재 계층에서 정의하는 정보
				4계층의 목적은 큰 데이털르 잘 분할하고 받는 쪽에서는 잘 조립하는 것이다.
					데이터에 순서를 정하고, 받는 패킷의 순서가 맞는지 빠진 패킷은 없는지 점검하는 역할이 중요하며 이 정보를 헤더에 적어 넣게 된다.
				TCP/IP의 4계층 프로토콜 TCP에서는 시퀀스, 애크 번호 필드로 이 데이터를 표현
				3계층 헤더에는 논리적인 주소인 출발지, 도착지 IP 주소를 헤더에 적어 넣는다.
				2계층은 MAC 주소를 정의하고 출발지, 도착지 MAC 주소 정보를 헤더에 넣는다.
			2. 상위 프로토콜 지시자
				상위 계층으로 올라갈수록 프로토콜 종류가 많아지는데, 디캡슐레이션하는 목적지 쪽에서는 헤더에 정보가 없으면 어떤 상위 프로토콜로 올려보내 주어야 할지 결정할 수 없다.
				그래서 인캡슐레이션하는 쪽에서는 헤더에 상위 프로토콜 지시자 정보를 포함해야 한다.
				프로토콜 지시자 이름은 4계층은 포트 번호, 3계층은 프로토콜 번호, 2계층은 이더 타입이라 부른다.

		MSS & MTU(데이터 크기 조절)
			네트워크에서 수용할 수 있는 크기를 역산정해 데이터가 4계층으로 내려올 때 적절한 크기로 쪼개질 수 있도록 유도한다.
				그 값을 MSS(Maximum Segment Size)
			네트워크에서 한 번에 보낼 수 있는 데이터 크기를 MTU(Maximum Transmission Unit)라고 부른다
				일반적인 이더넷에서 수용할 수 있는 크기는 1,500 바이트 이다.
			MTU값은 2계층의 데이터 값, MSS는 4계층에서 가질 수 있는 최대 데이터 값이다.
			2계층 헤더들의 크기를 제외한 데이터 크기를 MTU 크기라고 부른다
			IP 헤더와 TCP 헤더의 표준 헤더 크기는 일반적으로 각각 20바이트이므로 일반 이더넷인 경우, MSS 값을 1460바이트로 사용한다.
				3계층 헤더 20바이트, 4계층 헤더 20바이트, TCP MSS - 총1500바이트

```